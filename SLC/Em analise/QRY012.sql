SELECT DISTINCT 0 AS TIPOQUERY ,
( CASE F2_FILIAL WHEN '01' THEN '90055054000732' WHEN '02' 
THEN '90055054000570' WHEN '03' THEN '90055054000490' WHEN '04' 
THEN '90055054000147' WHEN '05' THEN '90055054000651' WHEN '06' 
THEN '90055054000902' WHEN '07' THEN '90055054000813' WHEN '08' 
THEN '90055054001038' WHEN '09' THEN '90055054001119' WHEN '10' 
THEN '90055054001208' WHEN '13' THEN '90055054001380' WHEN '14' 
THEN '90055054001461' WHEN '15' THEN '90055054001542' WHEN '16' 
THEN '90055054001623' WHEN '17' THEN '90055054001704' WHEN '18' 
THEN '90055054001895' WHEN '19' THEN '90055054001976' WHEN '20' 
THEN '90055054002000' WHEN '21' THEN '90055054002190' WHEN '22' 
THEN '90055054002271' WHEN '23' THEN '90055054002352' WHEN '24' 
THEN '90055054002433' WHEN '25' THEN '90055054002514' WHEN '26' 
THEN '90055054002603' WHEN '27' THEN '90055054002786' WHEN '28' 
THEN '90055054002867' WHEN '29' THEN '90055054002948' WHEN '30' 
THEN '90055054003081' WHEN '31' THEN '90055054003162' WHEN '32' 
THEN '90055054003243' WHEN '33' THEN '90055054003324' ELSE NULL END) CNPJORIGEMDADOS ,
CONCAT( VSC_FILIAL ,VSC_NUMOSV ,VSC.R_E_C_N_O_ ) AS ID ,VSC_CODPRO AS IDVENDEDOR ,
CONVERT(VARCHAR(10), CAST(VSC_DATVEN AS DATETIME), 121) AS DATACADASTRO ,
VSC_TIPTEM AS CODIGOTIPOTEMPO ,VSC_GRUSER AS CODIGOGRUPOSERVICO ,VO6_CODSER AS COD_SERVICO ,
VSC_TIPSER AS CODIGOTIPOSERVICO ,VSC_NUMNFI AS NUMERONFFATURAMENTO ,VSC_SERNFI AS SERIENFFATURAMENTO ,
VSC_NUMOSV AS NUMERO_ORDEM_SERVICO ,VSC_VALSER AS VALORSERVICO ,VSC_VALDES AS VALORDESCONTO ,
CONCAT ( VO4_FATPAR ,VO4_LOJA ) AS CODIGO_CLIENTE ,F2_VALBRUT AS VALOR_TOTAL_NOTA ,VSC_TEMCOB AS TEMPOCOBRADO ,
CONVERT(VARCHAR(10), CAST(VO4_DATFIN AS DATETIME), 121) AS DATA_FINALIZACAO_SERVICO ,VAI_CPF AS DOCUMENTOFUNCIONARIO ,
( CASE WHEN CONCAT ( VO6_XDZFID ,VO6_XDZSUP ) = 'SN' THEN '1' WHEN CONCAT ( VO6_XDZFID ,VO6_XDZSUP ) = 'NS' 
THEN '2' WHEN CONCAT ( VO6_XDZFID ,VO6_XDZSUP ) = 'SS' THEN '3' ELSE NULL END ) AS BUSINESS ,
CONCAT ( F2_FILIAL ,F2_DOC ,F2_SERIE ,F2_CLIENTE ,F2_LOJA ,F2_EMISSAO ,F2_CHVNFE ,F2_IDNF ) AS IDNFE ,
( CASE F2.F2_STATUS WHEN ' ' THEN 'Concluida' WHEN '015' THEN 'Cancelada' WHEN '025' THEN 'Pendente' ELSE NULL END ) AS STAUSNFE ,
CONCAT ( F2.F2_TIPO ,F2.F2_TIPODOC ) AS TIPOFATURAMENTO ,CONVERT(VARCHAR(10), CAST(F2.F2_EMISSAO AS DATETIME), 121) AS EMISSAONFE ,
CASE WHEN CAST(F2_EMISSAO AS DATE) < '2023-05-19' THEN CONVERT(VARCHAR, DATEADD(DAY, ((ASCII(SUBSTRING(F2_USERLGI, 12, 1)) - 50) * 100 + 
(ASCII(SUBSTRING(F2_USERLGI, 16, 1)) - 50)), '19960101'), 103) ELSE CONVERT(VARCHAR, CAST(DATEADD(DAY, CONVERT(INT, 
REPLACE(CONCAT ( ASCII(SUBSTRING(F2_USERLGI, 12, 1)) - 50 ,ASCII(SUBSTRING(F2_USERLGI, 16, 1)) - 50 ), '-', '')), '2023-05-19') AS DATETIME), 103) END AS DATA_INCLUSAO ,
CONVERT(VARCHAR, CAST(DATEADD(DAY, CONVERT(INT, REPLACE(CONCAT ( ASCII(SUBSTRING(F2_USERLGA, 12, 1)) - 50 ,
ASCII(SUBSTRING(F2_USERLGA, 16, 1)) - 50 ), '-', '')), '2023-05-19') AS DATETIME), 103) AS DATA_ALTERACAO ,
F2.R_E_C_N_O_ ,VO1.VO1_CHASSI AS CHASSI FROM VSC010 VSC JOIN VO4010 VO4 WITH (NOLOCK) ON VSC.VSC_FILIAL = 
VO4.VO4_FILIAL AND VSC.VSC_NUMOSV = VO4.VO4_NUMOSV AND VSC.VSC_RECVO4 = VO4.R_E_C_N_O_ AND VO4.D_E_L_E_T_ <> '*' 
LEFT JOIN SA1010 M WITH (NOLOCK) ON VO4.VO4_FATPAR = M.A1_COD AND VO4.VO4_LOJA = M.A1_LOJA AND M.D_E_L_E_T_ <> '*' 
INNER JOIN VO6010 VO6 WITH (NOLOCK) ON VO4.VO4_CODSER = VO6_CODSER AND VO6.D_E_L_E_T_ <> '*' 
LEFT JOIN VAI010 VA WITH (NOLOCK) ON VA.VAI_CODTEC = VO4.VO4_CODPRO AND VA.D_E_L_E_T_ <> '*' 
INNER JOIN VOI010 VO WITH (NOLOCK) ON VO.VOI_TIPTEM = VO4.VO4_TIPTEM AND VO.D_E_L_E_T_ <> '*' 
INNER JOIN SF2010 F2 WITH (NOLOCK) ON F2.F2_DOC = VO4.VO4_NUMNFI AND F2.F2_SERIE = VO4.VO4_SERNFI 
AND F2.F2_FILIAL = VO4.VO4_FILIAL AND F2.F2_LOJA = VO4.VO4_LOJA AND F2.D_E_L_E_T_ <> '*' 
LEFT JOIN VO1010 VO1 WITH (NOLOCK) ON VSC.VSC_FILIAL = VO1.VO1_FILIAL AND VSC.VSC_NUMOSV = VO1.VO1_NUMOSV 
WHERE VSC.D_E_L_E_T_ <> '*' AND ( ( 1 = 1 AND (CONVERT(VARCHAR, CAST(DATEADD(DAY, CONVERT(INT, REPLACE(CONCAT (ASCII(SUBSTRING(F2.F2_USERLGI, 12, 1)) - 50,
ASCII(SUBSTRING(F2.F2_USERLGI, 16, 1)) - 50), '-', '')), '2023-05-19') AS DATETIME), 20) >= '2025-04-20 00:00:00') AND (CONVERT(VARCHAR, CAST(DATEADD(DAY, 
CONVERT(INT, REPLACE(CONCAT (ASCII(SUBSTRING(F2.F2_USERLGI, 12, 1)) - 50,ASCII(SUBSTRING(F2.F2_USERLGI, 16, 1)) - 50), '-', '')), '2023-05-19') AS DATETIME), 20) <= GETDATE()) ) 
OR ( 1 = 1 AND (CONVERT(VARCHAR, CAST(DATEADD(DAY, CONVERT(INT, REPLACE(CONCAT (ASCII(SUBSTRING(F2.F2_USERLGA, 12, 1)) - 50,
ASCII(SUBSTRING(F2.F2_USERLGA, 16, 1)) - 50), '-', '')), '2023-05-19') AS DATETIME), 20) >= '2025-04-20 00:00:00') AND 
(CONVERT(VARCHAR, CAST(DATEADD(DAY, CONVERT(INT, REPLACE(CONCAT (ASCII(SUBSTRING(F2.F2_USERLGA, 12, 1)) - 50,
ASCII(SUBSTRING(F2.F2_USERLGA, 16, 1)) - 50), '-', '')), '2023-05-19') AS DATETIME), 20) <= GETDATE()) ) ) 
ORDER BY TIPOQUERY ASC, R_E_C_N_O_ ASC OFFSET 5000 ROWS FETCH NEXT 1000 ROWS ONLY
